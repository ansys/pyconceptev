Added progress monitor and tests